// Enable DSL2
nextflow.enable.dsl = 2

// Docker settings
docker {
    enabled = true
}

// Default parameters
params {
    // Required parameters with null defaults (must be provided by user)
    organism = null          // Organism name (e.g., 'Acinetobacter baylyi')
    outdir = null            // Output directory path
    library_layout = 'paired' // Library layout (paired, single, both)
    
    // Additional parameters with sensible defaults
    skip_fastq_download = false
    ena_metadata_fields = ''
    nf_core_pipeline = ''
    nf_core_rnaseq_strandedness = 'auto'
    sample_mapping_fields = ''
    download_method = 'ftp'
}

// Process-specific configurations
process {
    // Default process settings
    executor = 'local'
    
    // Docker container settings for each process
    withName: 'FETCH_METADATA' {
        container = 'quay.io/biocontainers/entrez-direct:22.4--he881be0_0'
    }
    
    withName: 'FORMAT_METADATA' {
        container = 'felixlohmeier/pandas:1.3.3'
    }
    
    withName: 'DOWNLOAD_REFERENCE' {
        container = 'staphb/ncbi-datasets:18.0.2'
    }
    
    withName: 'FASTQC_RAW' {
        container = 'quay.io/biocontainers/fastqc:0.12.1--hdfd78af_0'
    }
    
    withName: 'TRIMGALORE' {
        container = 'quay.io/biocontainers/trim-galore:0.6.9--hdfd78af_0'
    }
    
    withName: 'SALMON_INDEX' {
        container = 'quay.io/biocontainers/salmon:1.10.3--h45fbf2d_4'
    }
    
    withName: 'SALMON_QUANT' {
        container = 'quay.io/biocontainers/salmon:1.10.3--h45fbf2d_4'
    }
    
    withName: 'MULTIQC' {
        container = 'quay.io/biocontainers/multiqc:1.12--pyhdfd78af_0'
    }
}

// Profiles for different execution environments
profiles {
    standard {
        process.cpus = 4
        process.memory = '8 GB'
    }
    
    highcpu {
        process.cpus = 16
        process.memory = '32 GB'
    }
}

// Generate execution reports
report {
    enabled = true
    file = "${params.outdir}/reports/execution_report.html"
}

timeline {
    enabled = true
    file = "${params.outdir}/reports/execution_timeline.html"
}

dag {
    enabled = true
    file = "${params.outdir}/reports/pipeline_dag.svg"
}
